<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Crowdfunding DApp</title>
</head>
<body>
<h1>Crowdfunding</h1>
<button id="connect">Подключиться</button>
<button id="donate">Донатить 0.01 ETH</button>
<h2>История донатов:</h2>
<ul id="donations"></ul>

<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script>
const contractAddress = '0xb5E8ab8c3e222e81E9948bE90b1a447B624DEF4F';
const abi = [ // ABI вашего контракта
  "function donate() external payable", 
  "function getDonationCount() external view returns (uint)",
  "getDonations() external view returns (Donation[] memory)", 
  "function withdraw() external onlyOwner", 
  "function isFundingEnded() external view returns (bool)"
];

let provider;
let signer;
let contract;

document.getElementById('connect').onclick = async () => {
  await window.ethereum.request({ method: 'eth_requestAccounts' });
  provider = new ethers.providers.Web3Provider(window.ethereum);
  signer = provider.getSigner();
  contract = new ethers.Contract(contractAddress, abi, signer);
  alert('Подключено');
  loadDonations();
};

document.getElementById('donate').onclick = async () => {
  const tx = await contract.donate({ value: ethers.utils.parseEther('0.01') });
  await tx.wait();
  alert('Донат отправлен');
  loadDonations();
};

async function loadDonations() {
  const donations = await contract.getDonations();
  const list = document.getElementById('donations');
  list.innerHTML = '';
  donations.forEach(d => {
    const item = document.createElement('li');
    item.innerText = `${d.donor} — ${ethers.utils.formatEther(d.amount)} ETH at ${new Date(d.timestamp * 1000).toLocaleString()}`;
    list.appendChild(item);
  });
}
</script>
</body>
</html>